# Certificate authentication

It is possible to authenticate users based on their X.509 public key certificates. The steps involved in authenticating
a user based on his certificate are:

1. Generate a [cryptographic nonce](https://en.wikipedia.org/wiki/Cryptographic_nonce)
1. Ask the user to perform a signature algorithm computation on the nonce using his private key
1. Verify the nonce signature with the user certificate's public key
  1. It is also necessary to validate the nonce itself, checking that it was indeed generated by the application and
     that it has never before been used before. This is necessary to avoid certain attacks, such as
     [replay attacks](https://en.wikipedia.org/wiki/Replay_attack)
1. Validate the certificate itself, performing a number of checks such as that it was indeed issued by a trusted
   Certification Authority (CA), that it is within its validity period, that it has not been revoked and
   that it can be used for this purpose
1. If everything checks out, the application can trust that the user is indeed the subject of the certificate. Then,
   based on a key information on the certificate (e.g.: email address or ID number), locate a user on the database and
   complete the sign in process

To implement this process, you need to perform operations on both the front- and backend:

The signature algorithm computation over the nonce must necessarily be done on the **frontend** because the user
certificate's private key might be on a cryptographic device that never allows exporting it. Moreover, even if the
private key is software-based, it is a bad practice to ask the user for it.

The generation of the nonce and all validations must be done on the **backend**, for obvious security reasons.

To implement the frontend part, you can use [Web PKI](../web-pki/index.md), which exposes Javascript functions to:

* List the certificates available on the user's computer
* Read the encoding a certificate
* Perform a signature algorithm using a certificate's private key

To implement the backend part, you can use [Rest PKI](../rest-pki/index.md), which has specific APIs for this purpose.

> [!NOTE]
> If your application is a .NET application (C#, VB.NET or C++.NET), you can also use the [PKI SDK](../pki-sdk/index.md).
> However, we recommend starting with Rest PKI, because its use is simpler.
